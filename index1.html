<!DOCTYPE html>
<html lang="en">
<head>
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Fitness Tracker</title>
<meta name="apple-mobile-web-app-capable" content="yes">

<!-- Chart.js for charts -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<style>
body{font-family:-apple-system;background:#f2f2f7;padding:20px}
.card{background:#fff;padding:15px;margin-bottom:15px;border-radius:12px}
button,input,select{width:100%;padding:10px;margin-top:6px;font-size:15px}
button{background:#007aff;color:#fff;border:none;border-radius:10px}
.exercise{margin-top:12px}
.sets{display:flex;gap:6px}
.sets input{flex:1}
.small{font-size:13px;color:#666}
.timer{font-size:22px;font-weight:bold;text-align:center;margin-top:10px}
canvas{margin-top:10px;background:#f9f9f9;border-radius:8px;padding:10px}
</style>
</head>
<body>

<h2>ğŸ‹ï¸ Fitness Tracker</h2>
<p class="small">5-Day Strength + Optional Day 6 Cardio/Stretch â€¢ Mini Bar Charts â€¢ Local Only</p>

<!-- Day Select -->
<div class="card">
<h3>ğŸ“… Workout Day</h3>
<select id="daySelect" onchange="renderWorkout()">
  <option value="day1">Day 1 â€“ Upper (Push + Pull)</option>
  <option value="day2">Day 2 â€“ Lower</option>
  <option value="day3">Day 3 â€“ Cardio + Core</option>
  <option value="day4">Day 4 â€“ Upper (Angles)</option>
  <option value="day5">Day 5 â€“ Lower + Core</option>
  <option value="day6">Day 6 â€“ Optional Cardio / Stretch</option>
</select>
</div>

<!-- Warm-up -->
<div class="card">
<h3>ğŸ”¥ Daily Warm-Up (10 min)</h3>
<p class="small">
5 min treadmill / bike / elliptical<br>
Arm circles Ã—20<br>
Leg swings Ã—15/leg<br>
Hip circles Ã—10<br>
Bodyweight squats Ã—15
</p>
<button onclick="logSection('warmup')">Warm-Up Done</button>
</div>

<!-- Timer -->
<div class="card">
<h3>â± Rest Timer (60s)</h3>
<div id="timer" class="timer">60</div>
<button onclick="resetTimer()">Reset</button>
</div>

<!-- Workout Area -->
<div class="card" id="workoutArea"></div>

<!-- Body Weight -->
<div class="card">
<h3>âš–ï¸ Body Weight</h3>
<input id="bodyWeight" type="number" placeholder="Enter body weight">
<button onclick="saveBodyWeight()">Save</button>
</div>

<!-- Charts -->
<div class="card">
<h3>ğŸ“Š Todayâ€™s Progress</h3>
<canvas id="chartArea"></canvas>
</div>

<script>
const today = new Date().toLocaleDateString();
let timerInterval, timeLeft = 60;
let chartInstance;

const workouts = {
day1:[
["Chest Press",3],
["Pec Deck",3],
["Lat Pulldown",3],
["Seated Row",3],
["Shoulder Press",3],
["Lateral Raise Machine",3],
["Triceps Pushdown",3],
["Biceps Curl Machine",3]
],
day2:[
["Leg Press",4],
["Seated Leg Curl",3],
["Leg Extension",3],
["Hip Abductor",3],
["Calf Raise",4]
],
day3:[
["Ab Crunch Machine",3],
["Cable Woodchoppers (each side)",3],
["Plank (seconds)",3]
],
day4:[
["Incline Chest Press",3],
["Assisted Pull-Up / Wide Pulldown",3],
["Rear Delt Fly Machine",3],
["Shoulder Press",3],
["Face Pull",3],
["Triceps Dips (assisted)",3],
["Preacher Curl Machine",3]
],
day5:[
["Hack Squat / Leg Press",4],
["RDL Machine / Lying Curl",3],
["Walking Lunges (per leg)",3],
["Hip Thrust / Glute Bridge",3],
["Calf Raise",4],
["Hanging Knee Raises",3],
["Plank (seconds)",3]
],
day6:[
["Cardio Type / Duration",0],
["Stretching Exercises / Duration",0]
]
};

// Timer functions
function startTimer(){
 clearInterval(timerInterval);
 timeLeft=60;
 document.getElementById("timer").textContent=timeLeft;
 timerInterval=setInterval(()=>{
  timeLeft--;
  document.getElementById("timer").textContent = timeLeft<=0?"Rest Over!":timeLeft;
  if(timeLeft<=0) clearInterval(timerInterval);
 },1000);
}
function resetTimer(){
 clearInterval(timerInterval);
 timeLeft=60;
 document.getElementById("timer").textContent=60;
}

// LocalStorage functions
function getLog(){
 return JSON.parse(localStorage.getItem(today)||"{}");
}
function saveLog(d){
 localStorage.setItem(today,JSON.stringify(d));
 renderChart();
}

function logSection(s){
 const l = getLog();
 l[s] = "Done";
 saveLog(l);
}

// Workout render
function renderWorkout(){
 const day = document.getElementById("daySelect").value;
 const area = document.getElementById("workoutArea");
 area.innerHTML="<h3>ğŸ‹ï¸ Workout</h3>";

 // Load last week data for reference
 const lastWeek = JSON.parse(localStorage.getItem(day+"_lastWeek")||"{}");

 workouts[day].forEach((ex,index)=>{
  let div = document.createElement("div");
  div.className="exercise";
  let html=`<b>${ex[0]}</b>`;
  if(ex[1]>0){
    html+=`<div class="sets">`;
    for(let i=1;i<=ex[1];i++){
      let lastVal = lastWeek[ex[0]] ? lastWeek[ex[0]][i-1] : "";
      html+=`<input placeholder="Set ${i}" value="${lastVal}" oninput="startTimer()">`;
    }
    html+=`</div>`;
  } else {
    html+=`<p class="small">Log cardio type/duration or stretching here</p>`;
    html+=`<input placeholder="Type / Duration">`;
  }
  div.innerHTML = html;
  area.appendChild(div);
 });

 let btn=document.createElement("button");
 btn.textContent="Save Workout";
 btn.onclick=()=>saveWorkout(day);
 area.appendChild(btn);
}

// Save workout with history for chart
function saveWorkout(day){
 const inputs = [...document.querySelectorAll("#workoutArea input")].map(i=>i.value);
 const l = getLog();
 l.workout = inputs;
 saveLog(l);

 // Save for last week reference
 let lastWeekData = {};
 let exIndex = 0;
 workouts[day].forEach(ex=>{
   let arr = [];
   for(let i=0;i<ex[1];i++){
     arr.push(inputs[exIndex]||0);
     exIndex++;
   }
   lastWeekData[ex[0]] = arr;
 });
 localStorage.setItem(day+"_lastWeek", JSON.stringify(lastWeekData));
 renderChart();
}

// Save body weight
function saveBodyWeight(){
 const l = getLog();
 l.bodyWeight = document.getElementById("bodyWeight").value;
 saveLog(l);
}

// Render chart
function renderChart(){
 const l = getLog();
 const day = document.getElementById("daySelect").value;
 const ctx = document.getElementById("chartArea").getContext("2d");

 let labels=[], lastWeekData=[], thisWeekData=[];
 let lastWeek = JSON.parse(localStorage.getItem(day+"_lastWeek")||"{}");
 let inputIndex=0;

 workouts[day].forEach(ex=>{
  if(ex[1]>0){
    for(let s=1;s<=ex[1];s++){
      labels.push(ex[0]+" Set "+s);
      let lw = lastWeek[ex[0]] ? Number(lastWeek[ex[0]][s-1]||0) : 0;
      let tw = Number(l.workout ? l.workout[inputIndex++]||0 : 0);
      lastWeekData.push(lw);
      thisWeekData.push(tw);
    }
  } else {
    labels.push(ex[0]);
    lastWeekData.push(0);
    thisWeekData.push(0);
  }
 });

 if(chartInstance) chartInstance.destroy();
 chartInstance = new Chart(ctx,{
  type:"bar",
  data:{
   labels: labels,
   datasets:[
     {label:"Last Week", data:lastWeekData, backgroundColor:"rgba(0,123,255,0.4)"},
     {label:"This Week", data:thisWeekData, backgroundColor:"rgba(0,123,255,1)"}
   ]
  },
  options:{
   responsive:true,
   plugins:{legend:{position:"top"}},
   scales:{
     y:{beginAtZero:true}
   }
  }
 });
}

renderWorkout();
renderChart();
</script>

</body>
</html>
